<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Campañas Pendientes - Admin</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="/css/admin.css">
</head>
<body>
<div class="d-flex">
    <div class="sidebar">
        <div class="sidebar-content">
            <div class="sidebar-header">DonaPY ADMIN</div>
           <ul class="nav flex-column">
    <li class="nav-item"><a href="/admin/dashboard" class="nav-link <%= path.includes('/dashboard') ? 'active' : '' %>"><i class="fa-solid fa-tachometer-alt fa-fw"></i> Dashboard</a></li>
    <li class="nav-item"><a href="/admin/pending-campaigns" class="nav-link <%= path.includes('/pending-campaigns') ? 'active' : '' %>"><i class="fa-solid fa-clock-rotate-left fa-fw"></i> Pendientes</a></li>
    <li class="nav-item"><a href="/admin/donations" class="nav-link <%= path.includes('/donations') ? 'active' : '' %>"><i class="fa-solid fa-hand-holding-heart fa-fw"></i> Donaciones</a></li>
    <li class="nav-item"><a href="/admin/campaigns" class="nav-link <%= path.includes('/campaigns') ? 'active' : '' %>"><i class="fa-solid fa-bullhorn fa-fw"></i> Campañas</a></li>
    <li class="nav-item"><a href="/admin/users" class="nav-link <%= path.includes('/users') || path.includes('/user/') ? 'active' : '' %>"><i class="fa-solid fa-users fa-fw"></i> Usuarios</a></li>
    <li class="nav-item"><a href="/admin/withdrawals" class="nav-link <%= path.includes('/withdrawals') ? 'active' : '' %>"><i class="fa-solid fa-money-bill-wave fa-fw"></i> Retiros</a></li>
    <li class="nav-item"><a href="/admin/verifications" class="nav-link <%= path.includes('/verifications') ? 'active' : '' %>"><i class="fa-solid fa-id-card fa-fw"></i> Verificaciones</a></li>
    <li class="nav-item"><a href="/admin/reports" class="nav-link <%= path.includes('/reports') ? 'active' : '' %>"><i class="fa-solid fa-flag fa-fw"></i> Reportes</a></li>
    <li class="nav-item"><a href="/admin/banks" class="nav-link <%= path.includes('/banks') ? 'active' : '' %>"><i class="fa-solid fa-building-columns fa-fw"></i> Bancos</a></li>
    <li class="nav-item"><a href="/admin/settings" class="nav-link <%= path.includes('/settings') ? 'active' : '' %>"><i class="fa-solid fa-cog fa-fw"></i> Configuración</a></li>
</ul>
        </div>
        <div class="sidebar-footer"><a href="/campaigns" class="nav-link"><i class="fa-solid fa-arrow-left fa-fw"></i> Volver al Sitio</a></div>
    </div>

    <main class="main-content">
        <div class="container-fluid">
            <h1 class="h3 mb-2 text-gray-800">Revisión de Campañas Pendientes</h1>
            <p class="mb-4">Aprueba o rechaza las campañas una por una. Al procesar una, aparecerá la siguiente.</p>

            <% if (campaign) { %>
                <div class="card shadow mb-4">
                    <div class="card-header py-3">
                        <h6 class="m-0 font-weight-bold text-primary">Revisando: <%= campaign.title %></h6>
                    </div>
                    <div class="card-body">
                        <h5><strong>Organizador:</strong> <a href="/admin/user/<%= campaign.userId._id %>" target="_blank"><%= campaign.userId.username %></a></h5>
                        <p><strong>Categoría:</strong> <%= campaign.category %> | <strong>Meta:</strong> <%= new Intl.NumberFormat('es-PY').format(campaign.goalAmount) %> Gs.</p>
                        <hr>
                        <h5>Descripción</h5>
                        <div class="p-3 bg-light border rounded mb-3"><%- campaign.description %></div>
                        
                        <h5>Archivos Multimedia</h5>
                        <div class="row">
                            <% campaign.files.forEach(file => { %>
                                <div class="col-md-4 mb-3">
                                    <a href="<%= file %>" target="_blank">
                                        <img src="<%= file.replace('/upload/', '/upload/w_400,h_300,c_fill/') %>" class="img-fluid rounded border" alt="Archivo de campaña">
                                    </a>
                                </div>
                            <% }); %>
                        </div>
                        <hr>
                        <div class="d-flex justify-content-end gap-2 mt-3">
                             <form action="/admin/campaign/<%= campaign._id %>/update-status?redirect=pending" method="POST" onsubmit="return confirm('¿Aprobar esta campaña?');">
                                <input type="hidden" name="status" value="approved">
                                <button type="submit" class="btn btn-lg btn-success"><i class="fas fa-check"></i> Aprobar</button>
                            </form>
                             <form action="/admin/campaign/<%= campaign._id %>/update-status?redirect=pending" method="POST" onsubmit="return confirm('¿RECHAZAR esta campaña?');">
                                <input type="hidden" name="status" value="rejected">
                                <button type="submit" class="btn btn-lg btn-danger"><i class="fas fa-times"></i> Rechazar</button>
                            </form>
                        </div>
                    </div>
                </div>
            <% } else { %>
                 <div class="card shadow"><div class="card-body text-center p-5">
                    <i class="fas fa-check-circle text-success fa-3x mb-3"></i>
                    <h4>¡Todo al día!</h4>
                    <p class="text-muted">No hay campañas pendientes de revisión.</p>
                </div></div>
            <% } %>
        </div>
    </main>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>